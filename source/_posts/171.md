---
title: 层次聚类算法
categories: 机器学习
tags: 机器学习
mathjax: true
date: 2018-06-04 20:54:01
---

层次聚类(Hierarchical Clustering)是聚类算法的一种，通过计算不同类别数据点间的相似度来创建一棵有层次的嵌套聚类树。在聚类树中，不同类别的原始数据点是树的最低层，树的顶层是一个聚类的根节点。创建聚类树有**自下而上合并**和**自上而下分裂**两种方法，本篇文章介绍合并方法。

## 层次聚类的合并算法

层次聚类的合并算法通过计算两类数据点间的相似性，对所有数据点中最为相似的两个数据点进行组合，并反复迭代这一过程。简单的说层次聚类的合并算法是通过计算每一个类别的数据点与所有数据点之间的距离来确定它们之间的相似性，距离越小，相似度越高。并将距离最近的两个数据点或类别进行组合，生成聚类树。

## 欧几里得距离矩阵

层次聚类使用欧式距离来计算不同类别数据点间的距离（相似度），本篇文章将通过创建一个欧式距离矩阵来计算和对比不同类别数据点间的距离（相似性），并对距离值最小的数据点进行组合。

## 举例

假设有以下数据集：
![](/img/hierarchical-clustering1.png)

计算数据集中任意两点之间的欧式距离，得到以下矩阵：
![](/img/hierarchical-clustering2.png)

我们发现 B、C 两点之间的距离最小，合并 B、C 两点。接下来我们需要继续执行自下而上的合并过程，不过我们发现，这时我们需要计算一个点到一个点集的距离了，这时我们只需要计算一个点到这个点集中的所有点的距离的均值即可。
![](/img/hierarchical-clustering3.png)

我们发现 D、E 两点间的距离最小，合并 D、E 两点，接下来我们仍然需要继续执行自下而上的合并过程，这是我们又发现了新的问题，我们需要计算一个点集到另一个点集的欧式距离了。这是情况就变得稍微有点儿复杂了，计算两个点集之间的欧式距离有以下三种方式：

### Single Linkage

Single Linkage的计算方法是**将两个组合数据点中距离最近的两个数据点间的距离作为这两个组合数据点的距离**。这种方法容易受到极端值的影响。两个很相似的组合数据点可能由于其中的某个极端的数据点距离较近而组合在一起。

### Complete Linkage

Complete Linkage的计算方法与Single Linkage相反，**将两个组合数据点中距离最远的两个数据点间的距离作为这两个组合数据点的距离**。Complete Linkage的问题也与Single Linkage相反，两个不相似的组合数据点可能由于其中的极端值距离较远而无法组合在一起。

### Average Linkage

Average Linkage的计算方法是**计算两个组合数据点中的每个数据点与其他所有数据点的距离。将所有距离的均值作为两个组合数据点间的距离**。这种方法计算量比较大，但结果比前两种方法更合理。

这里我们用 Average Linkage 这种计算方法：
![](/img/hierarchical-clustering4.png)

我们发现 A、F 两点间的距离最小，合并 A、F 两点，继续执行合并过程：
![](/img/hierarchical-clustering5.png)

我们发现 (A, F) 点集与 (B,C) 点集之间的距离最小，所以接下来需要合并这两个点集：
![](/img/hierarchical-clustering6.png)

我们发现 (D, E) 点集与点 G 之间的距离最小，所以接下来需要合并这 (D, E) 这个点集和点 G：
![](/img/hierarchical-clustering7.png)

最后一步就是需要合并 (A,F,B,C) 和 (D,E,G) 这两个点集了，至此层次聚类完成。

## 层级聚类树状图
将前面的每一步的计算结果以树状图的形式展现出来就是层次聚类树。最底层是原始A到G的7个数据点。依照7个数据点间的相似度组合为聚类树的第二层(A,F),(B,C),(D,E)和G。以此类推生成完整的层次聚类树状图。以下为简单的示意图。
![](/img/hierarchical-clustering8.png)

## 参考
- [层次聚类算法的原理及实现Hierarchical Clustering](http://bluewhale.cc/2016-04-19/hierarchical-clustering.html)

